!function(){var y,l={top:0,bottom:0,left:0,right:0,again:0},C={};chrome.storage.sync.get(null,function(e){for(var t in e)C[t]=e[t]}),chrome.storage.onChanged.addListener(function(e){void 0!==e.linkQuery&&(C.linkQuery=e.linkQuery.newValue),void 0!==e.useHttps&&(C.useHttps=e.useHttps.newValue),void 0!==e.autoAudio&&(C.autoAudio=e.autoAudio.newValue),void 0!==e.defaultVoice&&(C.defaultVoice=e.defaultVoice.newValue),void 0!==e.selectMode&&(C.selectMode=e.selectMode.newValue),void 0!==e.toggleKey&&(C.toggleKey=e.toggleKey.newValue),void 0!==e.autoHide&&(C.autoHide=e.autoHide.newValue),void 0!==e.showDuration&&(C.showDuration=e.showDuration.newValue),void 0!==e.showPosition&&(C.showPosition=e.showPosition.newValue)});var d=function(e,t){var n=E(e,t);n.classList.add("ChaZD-result-side"),document.documentElement.appendChild(n),C.autoHide&&(y=setTimeout(function(){document.querySelector(".ChaZD-result-container")&&document.documentElement.removeChild(n)},1e3*C.showDuration))},c=function(e,t,n,o){var i=E(e,t),r=b();document.documentElement.appendChild(i),document.documentElement.appendChild(r);var a={};0===n.left&&0===n.top&&(n={left:o.clientX,top:o.clientY,height:15});var u=i.offsetWidth,l=n.right-n.left,d=n.left+window.pageXOffset,c=n.top+window.pageYOffset,s=d-(u-l)/2,m=l/2+d-12;s<window.pageXOffset?s=window.pageXOffset:s+u>window.pageXOffset+document.documentElement.clientWidth&&(s=window.pageXOffset+document.documentElement.clientWidth-u);var h=0;if(0===(h=document.documentElement.clientHeight>document.body.clientHeight?document.body.clientHeight:document.documentElement.clientHeight)&&(h=document.documentElement.clientHeight),150<=n.top){var f=h-c+10;a={left:s,bottom:f,arrowLeft:m,arrowBottom:1+f}}else a={left:s,top:c+n.height+12,arrowLeft:m,arrowTop:c+n.height+1};i.style.left=a.left+"px",r.style.left=a.arrowLeft+"px";var p,v,w=document.querySelectorAll(".ChaZD-arrow-outer"),g=document.querySelectorAll(".ChaZD-arrow-inner");if(a.bottom)for(i.style.bottom=a.bottom+"px",r.style.bottom=a.arrowBottom+"px",p=0,v=w.length;p<v;p++)w[p].classList.add("ChaZD-arrow-outer-down"),g[p].classList.add("ChaZD-arrow-inner-down");if(a.top)for(i.style.top=a.top+"px",r.style.top=a.arrowTop+"px",p=0,v=w.length;p<v;p++)w[p].classList.add("ChaZD-arrow-outer-up"),g[p].classList.add("ChaZD-arrow-inner-up");C.autoHide&&(y=setTimeout(function(){document.querySelector(".ChaZD-result-container")&&document.querySelector(".ChaZD-arrow-main")&&(document.documentElement.removeChild(i),document.documentElement.removeChild(r))},1e3*C.showDuration))},b=function(){var e=document.createElement("div");e.classList.add("ChaZD-arrow-main");var t=document.createElement("div");t.setAttribute("class","ChaZD-arrow-outer");var n=document.createElement("div");return n.setAttribute("class","ChaZD-arrow-inner"),e.appendChild(t),e.appendChild(n),e},E=function(e,t){var o=document.createElement("div");o.classList.add("ChaZD-result-container"),o.setAttribute("data-text",e);var i=document.createElement("div");return i.setAttribute("id","ChaZD-searching"),i.innerHTML="ψ(._. )>划词君正在翻译。。。",o.appendChild(i),chrome.runtime.sendMessage({queryWord:e,source:"select",useHttps:t},function(e){var t=e;if(i.innerHTML="","query success"===t.validMessage){o.innerHTML=t.titleBlock,function(e){var t=e.getAttribute("data-src"),n=document.createElement("audio");n.setAttribute("src",t+"&type="+C.defaultVoice),e.appendChild(n),!0===C.autoAudio&&n.play();n.addEventListener("ended",function(e){this.load()}),e.addEventListener("click",function(e){n.play()})}(o.querySelector(".voice-container"));var n=document.createElement("div");t.basicBlock?(n.innerHTML=t.basicBlock,o.appendChild(n)):t.haveTranslation?o.querySelector(".title-translation").style.display="block":t.haveWebTranslation?(n.innerHTML=t.webBlock,o.appendChild(n),o.querySelector(".web-title").innerHTML="网络释义"):o.innerHTML="╮(╯▽╰)╭划词君无能为力啊<br> 还是右键问问谷歌君吧=>"}else 20==t.errorCode?o.innerHTML="<p>这段文字太长，词典君无能为力了（┬_┬） <br><br>试试短一点的吧~</p>":40==t.errorCode?o.innerHTML="<p>对不起，这段文字太高深了，请饶过词典君吧（┬_┬）</p>":o.innerHTML="<p>词典君罢工啦（┬_┬）<br><br> 是不是网络不太好？<br><br> 稍后再试一次吧</p>"}),o};var a=["ChaZD-result-container","title-container","title-word","title-translation","basic-container","phonetic-container","explains-container","explains-container","explains-list","property-container","explains-item","voice-container","us-phonetic-container","uk-phonetic-container","web-explains-container","web-explains-list","web-key","explains-item-value","web-value"];document.documentElement.addEventListener("mousedown",function(e){for(var t in a)if(e.target.classList.contains(a[t]))return;clearTimeout(y);var n,o,i=document.querySelectorAll(".ChaZD-result-container"),r=document.querySelectorAll(".ChaZD-arrow-main");if(i)for(n=0,o=i.length;n<o;n++)document.documentElement.removeChild(i[n]);if(r)for(n=0,o=r.length;n<o;n++)document.documentElement.removeChild(r[n]);chrome.storage.sync.set({currentWord:""})}),window.addEventListener("resize",function(e){var t=document.querySelector(".ChaZD-result-container"),n=document.querySelector(".ChaZD-arrow-main");t&&document.documentElement.removeChild(t),n&&document.documentElement.removeChild(n)});function e(e){if("noSelect"!==C.selectMode){if("useCtrl"===C.selectMode)if("ctrl"===C.toggleKey){if(!e.ctrlKey&&!e.metaKey)return void(l.again=0)}else if("alt"===C.toggleKey){if(!e.altKey)return void(l.again=0)}else if("shift"===C.toggleKey&&!e.shiftKey)return void(l.again=0);!function(e){var t=window.getSelection&&window.getSelection();if(t&&0<t.rangeCount){var n=trim(t.toString()),o=t.getRangeAt(0).getBoundingClientRect();if(function(e,t){return e.top===t.top&&e.bottom===t.bottom&&e.left===t.left&&e.right===t.right}(o,l)&&l.again)return l.again=0;if(""===n||!/^[^\u4e00-\u9fa5]+$/.test(n))return;for(var i=document.documentElement.querySelectorAll(".ChaZD-result-container"),r=0,a=i.length;r<a;r++)if(i[r].getAttribute("data-text").toLowerCase()===n.toLowerCase())return;for(var u in chrome.storage.sync.set({currentWord:n},function(){}),l)l[u]="again"==u?1:o[u];"side"===C.showPosition&&d(n,C.useHttps),"near"===C.showPosition&&c(n,C.useHttps,o,e)}}(e)}}var n=null,t=function(e){n&&e.shiftKey&&(i(e),n.setAttribute("ChaZD-href",n.getAttribute("href")),n.removeAttribute("href"),n.classList.add("ChaZD-link"))},o=function(e,t){n&&(t||16==e.keyCode)&&(n.setAttribute("href",n.getAttribute("ChaZD-href")),n.removeAttribute("ChaZD-href"),n.classList.remove("ChaZD-link"))},i=function(e){C.linkQuery&&e.shiftKey&&window.getSelection().empty()};document.documentElement.addEventListener("mouseup",e),document.documentElement.addEventListener("mouseover",function(e){"A"!==e.target.nodeName&&"a"!==e.target.nodeName||function(e){C.linkQuery&&(n=e.target,e.shiftKey&&t(e))}(e)}),document.documentElement.addEventListener("mouseout",function(e){"A"!==e.target.nodeName&&"a"!==e.target.nodeName||function(e){C.linkQuery&&(n&&n.classList.contains("ChaZD-link")&&o(e,!0),n=null)}(e)}),document.documentElement.addEventListener("keydown",t),document.documentElement.addEventListener("keyup",o),document.documentElement.addEventListener("selectstart",e)}();